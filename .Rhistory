install.packages("neuralnet")
install.packages("mlbench")
# Tiempo dedicado a la entrega:
# Dificultades encontradas y manera de resolverlas:
##---------------------------------------------------------------------------
# 1. AsegÃƒÂºrese de incluir, junto a esta plantilla, cualquier fichero necesario
#    para su ejecuciÃƒÂ³n, incluidos datasets
# 2. Si utiliza una funciÃƒÂ³n de un determinado paquete, no olvide incluir la
#    correspondiente llamada a la funciÃƒÂ³n "library()"
# 3. No olvide comentar el cÃƒÂ³digo, en especial aquellos comandos no-triviales
#    (recuerda que parte de la calificaciÃƒÂ³n depende de la limpieza del cÃƒÂ³digo)
#---------------------------------------------------------------------------
rm(list = ls());cat("\014")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
library(neuralnet)
# Paso 1: Utilice la funciÃƒÂ³n read.csv para leer el contenido del fichero "hormigon.csv"
datos = read.csv("datos/hotmigon.csv")
# Paso 1: Utilice la funciÃƒÂ³n read.csv para leer el contenido del fichero "hormigon.csv"
datos = read.csv("datos/hormigon.csv")
View(datos)
library(clusterSim)
# Paso 2: Normalice todas las columnas del dataset (como en la prÃƒÂ¡ctica anterior)
datos = data.Normalization(datos,"n8","column")
View(datos)
# Paso 3: Utilice la funciÃƒÂ³n createDataPartition (paquete: caret) para dividir los datos en
# training (80%) y test (20%)
trainIndex = createDataPartition(datos$cement, p = 0.8, list = FALSE)
library(caret)
# Paso 3: Utilice la funciÃƒÂ³n createDataPartition (paquete: caret) para dividir los datos en
# training (80%) y test (20%)
trainIndex = createDataPartition(datos$cement, p = 0.8, list = FALSE)
datostra = datos[trainIndex,]
datostst = datos[-trainIndex,]
View(datos)
View(datos)
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
compute(modelo,datostst, 1)
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, 1)
View(evaluation)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
eam = mae(datostst$strength, evaluation)
library(ModelMetrics)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
eam = mae(datostst$strength, evaluation)
View(evaluation)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
eam = mae(datostst$strength, evaluation[,1])
strenght = datostst$strength
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, "best")
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, 2)
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, 1)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
eam = mae(datostst$strength, evaluation)
View(evaluation)
View(modelo)
View(evaluation)
View(evaluation)
evaluation[1]
evaluation[2]
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
eam = mae(datostst$strength, evaluation[2])
evaluation[2]
evaluation[2,2]
evaluation[[2]]
values = evaluation[2]
View(values)
values = unlist(evaluation[2])
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
eam = mae(datostst$strength, evaluation[2])
eam = mae(datostst$strength, values)
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 5,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, 1)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
values = unlist(evaluation[2])
eam = mae(datostst$strength, values)
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 8: Repita los pasos del 4 al 7 (guarde cada valor de MAE en una variable diferente) para
# las siguientes configuraciones:
# - Una red de una capa, con 5 neuronas
modelo1 = neuralnet(strength ~ ., datostra, hidden = 5,linear.output = FALSE)
plot(modelo1,"best")
# - Una red de una capa, con 100 neuronas
modelo2 = neuralnet(strength ~ ., datostra, hidden = 100,linear.output = FALSE)
plot(modelo2,"best")
# - Una red de 2 capas con 5 y 20 neuronas, respectivamente
modelo3 = neuralnet(strength ~ ., datostra, hidden = c(5,20),linear.output = FALSE)
plot(modelo3,"best")
# - Una red de 2 capas con 20 y 5 neuronas, respectivamente
modelo4 = neuralnet(strength ~ ., datostra, hidden = c(20,5),linear.output = FALSE)
plot(modelo4,"best")
# - Una red de 2 capas con 20 y 20 neuronas, respectivamente
modelo5 = neuralnet(strength ~ ., datostra, hidden = c(20,20),linear.output = FALSE)
plot(modelo5,"best")
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, 1)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
values = unlist(evaluation[2])
eam = mae(datostst$strength, values)
evaluation = compute(modelo1, datostst, 1)
values = unlist(evaluation[2])
eam1 = mae(datostst$strength, values)
evaluation = compute(modelo2, datostst, 1)
values = unlist(evaluation[2])
eam2 = mae(datostst$strength, values)
evaluation = compute(modelo3, datostst, 1)
values = unlist(evaluation[2])
eam3 = mae(datostst$strength, values)
evaluation = compute(modelo4, datostst, 1)
values = unlist(evaluation[2])
eam4 = mae(datostst$strength, values)
evaluation = compute(modelo5, datostst, 1)
values = unlist(evaluation[2])
eam5 = mae(datostst$strength, values)
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 8: Repita los pasos del 4 al 7 (guarde cada valor de MAE en una variable diferente) para
# las siguientes configuraciones:
# - Una red de una capa, con 5 neuronas
modelo1 = neuralnet(strength ~ ., datostra, hidden = 5,linear.output = FALSE)
plot(modelo1,"best")
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE, startweights = NULL)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
modelo4 = neuralnet(strength ~ ., datostra, hidden = c(20,10,5,2),linear.output = FALSE)
plot(modelo4,"best")
evaluation = compute(modelo4, datostst, 1)
values = unlist(evaluation[2])
eam4 = mae(datostst$strength, values)
evaluation = compute(modelo4, datostst, 1)
values = unlist(evaluation[2])
eam4 = mae(datostst$strength, values)
modelo4 = neuralnet(strength ~ ., datostra, hidden = c(20,10,5,2,1),linear.output = FALSE)
plot(modelo4,"best")
evaluation = compute(modelo4, datostst, 1)
values = unlist(evaluation[2])
eam4 = mae(datostst$strength, values)
rm(list = ls());cat("\014")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
# (incluya aquÃƒ­ cualquier librerÃƒ­a a utilizar)
library(neuralnet)
library(clusterSim)
library(caret)
library(ModelMetrics)
#---------------------------------------------------------------------------
# Paso 1: Utilice la funciÃƒÂ³n read.csv para leer el contenido del fichero "hormigon.csv"
datos = read.csv("datos/hormigon.csv")
# Paso 2: Normalice todas las columnas del dataset (como en la prÃƒÂ¡ctica anterior)
datos = data.Normalization(datos,"n8","column")
# Paso 3: Utilice la funciÃƒÂ³n createDataPartition (paquete: caret) para dividir los datos en
# training (80%) y test (20%)
trainIndex = createDataPartition(datos$cement, p = 0.8, list = FALSE)
datostra = datos[trainIndex,]
datostst = datos[-trainIndex,]
# Paso 4: Cree un modelo de perceptrÃƒÂ³n simple (1 capa con 1 neurona), haciendo uso de la funciÃƒÂ³n neuralnet
# para predecir la fuerza (columna strength) en funciÃƒÂ³n del resto de atributos.
# Mida el tiempo que tarda en entrenar y guÃƒÂ¡rdelo en una variable
# --> modelo = neuralnet(...)
# * Asegurese de que la red converge, por lo que posiblemente deba cambiar algÃƒÂºn parÃƒÂ¡metro, como
# * el umbral, nÃƒÂºmero de pasos mÃƒÂ¡ximos o repeticiones
modelo = neuralnet(strength ~ ., datostra, hidden = 1,linear.output = FALSE)
# Paso 5: Dibuje la "red" resultante haciendo uso del comando "plot"
plot(modelo,"best")
# Paso 6: Realice predicciones para los datos de test, utilizando la funciÃƒÂ³n "compute"
evaluation = compute(modelo,datostst, 1)
# Paso 7: Calcule el error absoluto medio (mean absolute error, MAE) entre las predicciones y la
# columna strength de conjunto de datos de test
# * Puede calcularlo o utilizar una (de las varias) implementaciones que hay disponibles en R
values = unlist(evaluation[2])
eam = mae(datostst$strength, values)
# Paso 8: Repita los pasos del 4 al 7 (guarde cada valor de MAE en una variable diferente) para
# las siguientes configuraciones:
# - Una red de una capa, con 5 neuronas
modelo1 = neuralnet(strength ~ ., datostra, hidden = 5,linear.output = FALSE)
plot(modelo1,"best")
evaluation = compute(modelo1, datostst, 1)
values = unlist(evaluation[2])
eam1 = mae(datostst$strength, values)
# - Una red de una capa, con 100 neuronas
modelo2 = neuralnet(strength ~ ., datostra, hidden = 100,linear.output = FALSE)
plot(modelo2,"best")
evaluation = compute(modelo2, datostst, 1)
values = unlist(evaluation[2])
eam2 = mae(datostst$strength, values)
# - Una red de 2 capas con 5 y 20 neuronas, respectivamente
modelo3 = neuralnet(strength ~ ., datostra, hidden = c(5,20),linear.output = FALSE)
plot(modelo3,"best")
evaluation = compute(modelo3, datostst, 1)
values = unlist(evaluation[2])
eam3 = mae(datostst$strength, values)
# - Una red de 2 capas con 20 y 5 neuronas, respectivamente
modelo4 = neuralnet(strength ~ ., datostra, hidden = c(20,5),linear.output = FALSE)
plot(modelo4,"best")
evaluation = compute(modelo4, datostst, 1)
values = unlist(evaluation[2])
eam4 = mae(datostst$strength, values)
# - Una red de 2 capas con 20 y 20 neuronas, respectivamente
modelo5 = neuralnet(strength ~ ., datostra, hidden = c(20,20),linear.output = FALSE)
plot(modelo5,"best")
evaluation = compute(modelo5, datostst, 1)
values = unlist(evaluation[2])
eam5 = mae(datostst$strength, values)
# Para todas ellas, guarde el MAE y tiempo en variables separadas
# Paso 9: Analice los resultados en funciÃƒÂ³n del tiempo de entrenamiento y MAE, Ã‚Â¿cuÃƒÂ¡l funciona mejor?
# Ã‚Â¿Son los resultados coherentes con lo visto en clase?
